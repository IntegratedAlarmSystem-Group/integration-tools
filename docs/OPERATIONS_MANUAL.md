# Operations Manual

# Introduction

The ALMA Observatory consists of many hardware and software systems which are continuously generating data. The related operations, depends on the availability of high-level and easy-to-understand information, about the status for these multiple systems.

The Integrated Alarm System (IAS) is a tool developed to improve the situation awareness of the ALMA operators.

The IAS provides a set of displays with global and specialized views of the status of the different systems, according to a set of alarms generated by the IAS. The information is presented in an integrated and homogeneous way, in order to help the operators to interpret this information, and to get more details, in order to make informed decisions.

Operators can perform actions as the *acknowledgement* or *shelving* of alarms.

Other user groups are able to access the displays, but some actions could be restricted according to specific permissions. The description of the authentication and authorization system for the IAS can be found at the end of this document.

# Technical Overview

Broadly, the IAS consists on three groups of components:


- a set of *plugins*, software which get the raw data and inject information to the system;


- the *core*, main component of the system which, among other tasks, generates alarms for the different monitoring points, from data provided by the plugins; and


- the *display* component, which take the alarms as an input and organize this information in different pages or *views*, in order to provide an efficient way to find and interpret the information related to this alarms.

Detailed information about the system can be found in the documentation about its design and architecture, available in the [docs](https://github.com/IntegratedAlarmSystem-Group/IntegratedAlarmSystem-Group.github.io/tree/master/docs) folder in the  [IntegratedAlarmSystem-Group.github.io](https://github.com/IntegratedAlarmSystem-Group/IntegratedAlarmSystem-Group.github.io) repository.

# Alarms

The alarms organized in the displays of the system, are displayed using combinations of the marks exposed in the following legend, according to different properties.

![Alarms Legend](./images/selected/legend.png)

The representation for the alarms can be illustrated by the following cases.

| Status  | Value | Validity |  Priority |
|---|---|---|---|
| ![Clear-Valid](./images/selected/clear-valid.png) ![Priority](./images/selected/priority-0.png) | clear | valid | |
| ![Clear-Invalid](./images/selected/clear-invalid.png) ![Priority](./images/selected/priority-0.png)  | clear | invalid | |
| ![Set-Valid-Low](./images/selected/set-valid-low.resized.png) ![Priority](./images/selected/priority-1.png)  | set | valid | low |
| ![Set-Invalid-Low](./images/selected/set-invalid-low.resized.png) ![Priority](./images/selected/priority-1.png) | set | invalid | low |
| ![Set-Valid-Medium](./images/selected/set-valid-low.resized.png) ![Priority](./images/selected/priority-2.png)  | set | valid  | medium |
| ![Set-Invalid-Medium](./images/selected/set-invalid-low.resized.png) ![Priority](./images/selected/priority-2.png) | set | invalid  | medium |
| ![Set-Valid-High](./images/selected/set-valid.png) ![Priority](./images/selected/priority-3.png)  | set | valid | high |
| ![Set-Invalid-High](./images/selected/set-invalid.png) ![Priority](./images/selected/priority-3.png) | set |  invalid | high |
| ![Set-Valid-High](./images/selected/set-valid.png) ![Priority](./images/selected/priority-4.png) | set | valid | critical |
| ![Set-Invalid-High](./images/selected/set-invalid.png) ![Priority](./images/selected/priority-4.png) | set |  invalid | critical |

First, we have the *clear* and *set* value, used when an alarm is resolved or if a condition configured in the system for the related device is not satisfied, respectively. The mark related to each status is shown in green, for the *clear* value, and red or yellow, for the *set* value.

The usage of the colors red and yellow depends on the priority level of the alarm: low, medium, high and critical, from lowest to highest.

Each alarm is validated by receiving regular messages from the system, according to a tolerance range of time. If these messages are received within this tolerance, then the status of the alarm is also declared as *valid;* if not, it is declared as *invalid*. We can tell the difference between a *valid* alarm and a *invalid* alarm because a valid alarm will be shown with a filled mark, whereas an invalid alarm will be shown with an unfilled mark.

Finally, each alarm has a related *operational mode*, which can be used to get contextual information related to the monitoring point. Some selected modes are highlighted in the displays for the operators, such as the *maintenance* mode and the *unknown* mode.

| Status  | Validity | Mode |
|---|---|---|
| ![Alarm](./images/selected/maintenance-valid.png) ![Priority](./images/selected/priority-0.png) | valid |  maintenance |
| ![Alarm](./images/selected/maintenance-invalid.png) ![Priority](./images/selected/priority-0.png) | invalid  | maintenance |
| ![Alarm](./images/selected/unknown-valid.png) ![Priority](./images/selected/priority-0.png) | valid | unknown |
| ![Alarm](./images/selected/unknown-invalid.png) ![Priority](./images/selected/priority-0.png)  | invalid | unknown |

According to the IAS configuration, an alarm can also have dependencies related to other alarms according to a hierarchy, for example, when monitoring points are related to a selected device and its subcomponents.

# Actions

Three type of actions can be triggered per alarm (depending on its status): *acknowledgement* (ack), *shelving* (shelve), and a *go to documentation* option.
These actions are available through the different pages of the web application, according to the following icons.


| Icon  | Action  |
|---|---|
| ![Ack](./images/selected/ack-on.png) | ack  |
| ![Shelve](./images/selected/shelve.png)  | shelve  |
| ![Go to docs](./images/selected/goto.resized.png)  | go to documentation  |

Usually, a set of buttons for each action will be displayed aside the status of an alarm.

![Actions](./images/selected/actions.png)

## Acknowledgment

The operators are requested to use the *ack* action each time an alarm is active.

![Ack Form](./images/selected/ack_form.png)

To acknowledge an alarm, the operator can click on the *ack* button to open an *acknowledgement form* to be submitted, in order to keep a log.
This form must contain: the decision taken in response to the problem and also an identifier for the member of the team of operators which acknowledge the alarm.
After completing the form, the *Acknowledge* button will be available to perform the *ack* action.

If it applies, the operator can also select a list of dependencies to do the acknowledgment for an alarm, in order to avoid the acknowledgment action without noticing the root cause of the activation.

![Ack Tree View](./images/selected/ack_tree_view.png)

We should notice that an active alarm will retain its active status even if it is acknowledged, until the problem is solved.

[Add photo of ack state]

When an alarm changes its status to a new one with a *set* value, it can be acknowledged just one time. Once an alarm is acknowledged, the related action button will be disabled.

[Disabled button case?]

Users with no acknowledgment permissions will receive a message after trying to perform this action. Only operators can acknowledge an alarm.

[Add photo of the ack message for not allowed users]

## Shelving

An operator can use the Shelve option when they need to temporarily silence an alarm so this alarm does not distract them while the problem with this alarm is being solved.

![Shelve Form](./images/selected/shelve_form.png)

The shelve action requires a description and it also requires setting up a shelving time, that ranges from 15 minutes to 12 hours top. After that, the alarm goes back to its original state.

[Example of shelved alarm]

Once an alarm was shelved, the *shelve* button will be replaced by an *unshelve* button to perform the inverse action, if necessary.

[Image with the unshelve button]

Users with no shelving permissions will receive a message after trying to perform this action. Only operators can shelve an alarm.

[Add photo of the shelving message for not allowed users]

## Other actions

Finally,  an operator can use the *go to documentation* option, which allows the user to look for additional information so they can make an informed decision.

This option could be found at the end of the actions available for each alarm.

[Add image of go to documentation option]


# Views

The IAS offers a view with panels that summarize the alarms per system, as well as specialized views for these systems.

Currently, the views availables in the IAS are: Overview, Weather Station, Antennas and a Tabular view.

These views share a set of main components which are described below.

**Toolbar**

Component placed at the top of the application. Here the user can find, at the right, a user's menu, with the name of the currently used account for authentication.

**Navigation Sidenav**
A navigation bar placed at the left of the screen can be used to explore the available views.

The *collapse menu button* available at the right of the toolbar, can be used to expand this component, to display the names of the views.

**Content**
Container for the main content for each view.

**Action Sidenav**
Views that allows the *ack* and *shelve* actions on the alarms, share an additional sidenav component with the related forms.

## Global Views

**Overview**
![Overview](./images/selected/overview.png)

In the current Overview the users will find 3 small panels with global information about the alarms related to the:

- *IAS Health*, that shows the general *health* of the system (if software components working properly);
- *Weather Station* status, that have summaries of their specific indicators (wind speed, humidity and temperature), and the
- *Antenna* status.

It is important to notice that the overview GUI can contain several panels, in order to show the information of other systems contained in the IAS.

**Tabular View**
![Overview](./images/selected/tabular.png)

In this view all the alarms generated by the IAS are organized in a table. Each row contains the following information:

- a global status for the alarm, according to its different values,
- an identifier for the alarm,
- the operational mode,
- the time of the last change in the status of the alarm,
- a brief description, and
- related actions.

Notice that the information shown about the alarms is related to its current state.

*Filtering and sorting*

Currently, the operators can use the text filter to look for particular alarms, and they also can activate predefined filters according to specific properties for the alarms.

![Overview](./images/selected/filters.png)

The operator can also use the sorting options for the different columns in the table.


## Specialized Views

**Weather View**
![Weather](./images/selected/weather.png)

The weather view shows a set of alarms related to weather conditions that can affect the functioning of the antennas.

This section displays the alarms information both using a list view and a graphical support in the form of a map. This map was build using a transformation on the geographic coordinates in order to have a better representation, because of the different distances between the pads where the antennas are located.

![Weather Selected](./images/selected/weather_selected.png)

*Sidebar*

The sidebar lists the alarms for the weather stations. Each weather station has three sub-alarms (wind speed, humidity and temperature), with the *ack*, *shelve*, and *go to documentation* options available for each alarm.

Also it provides a list of nearby antennas that could be affected by the monitored conditions.

These antennas are shown both in the map and the list view.

*Map*

Additionally, the Weather Station section uses a map of the summit to show in a more visual way the information mentioned before. The map shows:

- the pads for the antennas (unfilled circles),
- the current location of the antennas (filled circles) and
- the main Weather Stations with information about its sub-alarms.

When selecting one of these weather stations, the associated pads and associated antennas are highlighted.

**Antennas View**
![Antennas](./images/selected/antennas.png)

The antennas view shows the information about the alarms related to each antenna (currently, those related to the *Utility Module*).

This view, uses a similar structure that the one is used for the weather stations.

![Antennas Selected](./images/selected/antennas_selected.png)

*Sidebar*

When we access each antenna we can see a list of the related alarms. Currently, we can find the alarms from the *Utility Module*, listed below:

- Fire
- Fire Malfunction
- UPS Failure
- HVAC Failure
- Power Cut

*Map*

Unlike the map used in the Weather Station view, in this section only the antennas (and pads) are shown in the map.

The user can click on any antenna to open the sidebar with the details described before.


# Authentication and Permissions

The current version of the IAS has an authentication and authorization system, according to selected user permissions.
